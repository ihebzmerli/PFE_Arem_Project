<nb-card>
  <nb-card-header>
    Bon Livraison Table

    <nb-card-body>
      <div *ngIf="authority==='ROLE_ADMIN' || authority==='ROLE_PREPARATEUR_BR' || authority==='ROLE_RESPONSABLE_DISPATCHING_BP' || authority==='ROLE_RESPONSABLE_POINTAGE'" class="border">
          <button class="btn btn-md btn-outline-primary" (click)="goToCharts()">
          <i class="fa fa-user"></i>Statistiques</button>

          <button type="button" (click)="togglepreviewTableBonLiv()" class="btn btn-outline-info">
            {{previewTableAllBonlivExcelPdf? "tableau detailé": "tableau minimiser"}}
          </button>
      </div>
    </nb-card-body>
  </nb-card-header>

  <nb-card-body>
    <div *ngIf="!previewTableAllBonlivExcelPdf" class="container">
      Recherche Table: <input nbInput style="width:230px" class="form-control" type="text" name="search" [(ngModel)]="searchText" autocomplete="off" placeholder="&#61442;  Recherche Global">
      <table class="table table-bordered table-striped">
        <thead>
        <tr>
          <th style="text-align: center">
            <label class="label">NUM_BON</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search NumBon"
              style="width:150px" [(ngModel)]="searchTermNumBon" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">DAT_BON
              <button (click)="FilterDate(startDate,endDate)" class="btn btn-md btn-outline-warning">{{ testStatus === 1 ? 'Filter' : 'Annuler' }}</button></label>
            <div class="form-group">
              <div>
                <label class="label">Date Debut: </label>
                <input 
                style="width:110px"
                nbInput
                placeholder="Form Picker"
                [(ngModel)]="startDate"
                [nbDatepicker]="dateTimePicker" [ngModelOptions]="{standalone: true}">
                <nb-datepicker #dateTimePicker></nb-datepicker>
              </div>
              <div>
                <label class="label">Date Fin: </label>
                <input 
                style="width:110px"
                nbInput
                placeholder="Form Picker"
                [(ngModel)]="endDate"
                [nbDatepicker]="formpickertest" [ngModelOptions]="{standalone: true}">
                <nb-datepicker #formpickertest></nb-datepicker>
              </div> 
            </div>
            <!--
            <div class="form-group">
              <input nbInput style="width:150px" [(ngModel)]="searchTermDatBon" placeholder="Form Picker" [nbDatepicker]="formpicker">
              <nb-datepicker #formpicker></nb-datepicker>
              <input nbInput style="width:150px" [(ngModel)]="searchTermDatBon" placeholder="Form Picker" [nbDatepicker]="formpicker">
              <nb-datepicker #formpicker></nb-datepicker>
            </div>
            -->
          </th>
          <th style="text-align: center">
            <label class="label">COD_CLI</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search CodCli"
              style="width:150px" [(ngModel)]="searchTermCodCli" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">Adresse Client</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Adresse Cli"
              style="width:150px" [(ngModel)]="searchTermAdresseCli" />
            </div>
          </th>
          <th style="text-align: center;">
            <label class="label">codFrs</label>
            <div class="form-group">
              <nb-select style="width:150px" id="listmarquearticle" [(ngModel)]="_searchTermMarque" fullWidth fieldSize="small" (selectedChange)="getAllListFournis($event)" [ngModelOptions]="{standalone: true}">
                <nb-option value="">-Annuler Filter-</nb-option>
                <nb-option *ngFor="let itemsFournis of fournisAllList" [value]="itemsFournis.codFrs"> {{ itemsFournis.codFrs }} </nb-option>
              </nb-select>
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">numBonFrs</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search num_Bon_Frs"
              style="width:150px" [(ngModel)]="searchTermNumBonFrs" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">RAISON</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Raison"
              style="width:150px" [(ngModel)]="searchTermRaison" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">BRUT_HT</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Brut_Ht"
              style="width:150px" [(ngModel)]="searchTermBrutHt" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">TAUX_REM</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Taux_Rem"
              style="width:150px" [(ngModel)]="searchTermTauxRem" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">MONT_REM</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Mont_Rem"
              style="width:150px" [(ngModel)]="searchTermMontRem" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">NET_HT</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Net_Ht"
              style="width:150px" [(ngModel)]="searchTermNetHt" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">MONT_TVA</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Mont_Tva"
              style="width:150px" [(ngModel)]="searchTermMontTva" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">TOT_TTC</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Tot_Ttc"
              style="width:150px" [(ngModel)]="searchTermTotTtc" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">NUM_FAC</label>
          </th>
          <th style="text-align: center">
            <label class="label">TAUX_RES</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Taux_Res"
              style="width:150px" [(ngModel)]="searchTermTauxRes" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">MONT_TRS</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Mont_Trs"
              style="width:150px" [(ngModel)]="searchTermMontTrs" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">LIV</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Liv"
              style="width:150px" [(ngModel)]="searchTermLiv" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">Transaction</label>
            <div class="form-group">
              <nb-select style="width:170px" id="listTransaction" fullWidth fieldSize="small" (selectedChange)="getAllListTransaction($event)" >
                <nb-option value="">-Annuler Filter-</nb-option>
                <nb-option *ngFor="let itemsTransaction of statusessTransaction" [value]="itemsTransaction.value"> 
                  <div style="width: 300px;" *ngIf="itemsTransaction.label=='Reçu'" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color: rgb(120, 13, 134);" >le Bon Livraison est reçu</div></span></div>
                  <div style="width: 300px;" *ngIf="itemsTransaction.label=='Envoyer'" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color:rgb(6, 105, 122);">le Bon Livraison est envoyer</div></span></div>
                  <div style="width: 300px;" *ngIf="itemsTransaction.label==''" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color: rgb(160, 168, 160);">L'etat de bon livraison n'est pas definie </div></span></div>                  
                </nb-option>
              </nb-select>
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">COMMAND</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Command"
              style="width:150px" [(ngModel)]="searchTermCommand" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">POINTAGE</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Pointage"
              style="width:150px" [(ngModel)]="searchTermPointage" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">MONT_IRPP</label>
          </th>
          <th style="text-align: center">
            <label class="label">POSTE</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Poste"
              style="width:150px" [(ngModel)]="searchTermPoste" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">CENTRE</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Centre"
              style="width:150px" [(ngModel)]="searchTermCentre" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">CODE_TVA</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Code_Tva"
              style="width:150px" [(ngModel)]="searchTermCodeTva" />
            </div>
          </th>
          <th style="text-align: center">
            <label class="label">PLUS_V</label>
            <div class="form-group">
              <input type="text" nbInput class="form-control" placeholder="search Plus_V"
              style="width:150px" [(ngModel)]="searchTermPlusV" />
            </div>
          </th>
          <th style="text-align: center"><label class="label">Actions</label></th>
<!--
          <th>XBASE0</th>
          <th>XBASE6</th>
          <th>XBASE10</th>
          <th>XBASE17</th>
          <th>XBASE29</th>
          <th>XBASE7</th>
          <th>XBASE12</th>
          <th>XBASE21</th>
          <th>XBASE36</th>
          <th>XTVA6</th>
          <th>XTVA10</th>
          <th>XTVA17</th>
          <th>XTVA29</th>
          <th>XTVA7</th>
          <th>XTVA12</th>
          <th>XTVA21</th>
          <th>XTVA36</th>
          <th>XBASE19</th>
          <th>XTVA19</th>
          <th>XBASE13</th>
          <th>XTVA13</th>
          <th>XBASE7A</th>
          <th>XTVA7A</th>
-->
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let bonliv of filteredBonLivs | filter:searchText">
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.numBon}}</p></span>
            <img src="assets/images/toulsImages/print.png" width="32" style="vertical-align: middle" (click)="generatePdf(bonliv.numBon)" nbPopover="Imprimer le bon de livraison?" nbPopoverTrigger="hint" nbPopoverPlacement="right"/>
          </td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.datBon | date: 'MMM d, y H:mm:ss' : '+0000'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.nomprenomCli}}</p></span></td>
          <td><span><p>{{bonliv.adresseCli}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag">
            <ng-container *ngIf="bonliv.fournis; else newDeb" >
              <p>{{bonliv.fournis.codFrs}}</p>
          </ng-container>
          <ng-template #newDeb>
            <p>...</p>
          </ng-template>
          </td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.numBonFrs}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.raison}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.brutHt | currency:'TND ' : 'symbol'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.tauxRem | currency:'TND ' : 'symbol'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.montRem | currency:'DT ':'symbol'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.netHt | currency:'TND ' : 'symbol'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.montTva}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.totTtc | currency:'TND ' : 'symbol'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.numFac}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.tauxRes}} %</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.montTrs | currency:'TND ' : 'symbol'}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.liv}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag">
            <div *ngIf="bonliv.trans_action">
              <div style="width: 300px;" *ngIf="bonliv.trans_action=='recu'" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color: rgb(120, 13, 134);" >le Bon Livraison est reçu</div></span></div>
              <div style="width: 300px;" *ngIf="bonliv.trans_action=='envoyer'" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color:rgb(6, 105, 122);">le Bon Livraison est envoyer</div></span></div>
              <div style="width: 300px;" *ngIf="bonliv.trans_action==''" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color: rgb(160, 168, 160);">L'etat de bon livraison n'est pas definie </div></span></div>  
            </div> 
          </td>
          <td style="text-align: center" class="field-multiple-drag"><span *ngIf="bonliv.numCom!==null"><p>{{bonliv.numCom.numCom}} : {{bonliv.numCom.raison}}</p></span><span *ngIf="bonliv.numCom===null"><p>Aucune</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.pointage}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.montIrpp}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.poste}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.centre}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.codeTva}}</p></span></td>
          <td style="text-align: center" class="field-multiple-drag"><span><p>{{bonliv.plusV}}</p></span></td>
<!--
          <td class="field-multiple-drag"><span>{{bonliv.xbase0}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase6}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase10}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase17}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase29}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase7}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase12}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase21}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase36}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva6}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva10}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva17}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva29}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva7}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva12}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva21}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva36}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase19}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva19}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase13}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva13}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xbase7A}}</span></td>
          <td class="field-multiple-drag"><span>{{bonliv.xtva7A}}</span></td>
-->
          <td class="field-multiple-drag">
            <div class="buttons-row">
              <div class="form-groupe">
                <button style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton type="button" [status]="info" [size]="small" [shape]="semi-round" class="btn btn-md btn-outline-info" [routerLink]="['bon-liv-detail',bonliv.numBon]" outline>
                  <i class="fa fa-search"></i>Details</button>
                  <button (click)="openWindowXbaseXtva(bonliv.numBon)" style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton type="button" [shape]="semi-round" [size]="medium" [status]="primary" class="btn btn-md btn-outline-primary" outline>
                    XBASE & XTVA</button>
              </div>
              <div *ngIf="authority==='ROLE_ADMIN' || authority==='ROLE_PREPARATEUR_BR' || authority==='ROLE_RESPONSABLE_DISPATCHING_BP' || authority==='ROLE_RESPONSABLE_POINTAGE'" class="form-groupe">
                <button style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton type="button" [status]="warning" [size]="small" [shape]="semi-round" class="btn btn-md btn-outline-warning" (click)="goToModifier(bonliv.numBon)" outline>
                  <i class="fa fa-edit"></i>Modifier</button>
                <button style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton class="btn btn-md btn-outline-danger" type="button" [shape]="semi-round" [size]="medium" [status]="danger" (click)="OpenDeletePopap(bonliv.numBon)" outline>
                  <i class="fa fa-remove"></i>Supprimer</button>
              </div>
            </div>  
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </nb-card-body>

  <nb-card-body>
    <div *ngIf="previewTableAllBonlivExcelPdf">
        <p-table #dt [columns]="cols" [value]="filteredBonLivs" selectionMode="multiple" [(selection)]="selectedBonlivs" 
        dataKey="numBon" [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading" class="p-tableCss" styleClass="p-datatable-customers p-datatable-gridlines"
        [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        [globalFilterFields]="['numBon','nomprenomCli','adresseCli','datBon','numCom.fournis.codFrs','numCom.fournis.raison','numBonFrs','livreur.nom','raison','brutHt','tauxRem','montRem','netHt',
        'montTva','totTtc','tauxRes','montTrs','liv','trans_action','montIrpp','centre','user.firstname','numCom.user.firstname','user.roles[0].name','numCom.user.roles[0].name']">
          <ng-template pTemplate="caption">
              <div class="p-d-flex">
                <div class="container">
                  <div class="row">
                    <div class="col">
                      <button type="button" pButton pRipple icon="pi pi-file-o" (click)="dt.exportCSV()" class="p-mr-2" pTooltip="CSV" tooltipPosition="bottom" nbPopover="Télécharger toute la table en un ficher CSV?" nbPopoverTrigger="hint" nbPopoverPlacement="top"></button>
                      <button type="button" pButton pRipple icon="pi pi-file-excel" (click)="exportExcel()" class="p-button-success p-mr-2"  pTooltip="XLS" tooltipPosition="bottom" nbPopover="Télécharger toute la table en un ficher Excel?" nbPopoverTrigger="hint" nbPopoverPlacement="top"></button>
                    </div>
                    <div class="col-6">
                    </div>
                    <div class="col">
                      <button type="button" pButton pRipple icon="pi pi-filter" (click)="dt.exportCSV({selectionOnly:true})" class="p-button-secondary p-ml-auto" pTooltip="Selection Only" tooltipPosition="bottom" nbPopover="Télécharger les colones selectionner en un ficher CSV?" nbPopoverTrigger="hint" nbPopoverPlacement="top"></button>
                      <button type="button" pButton pRipple icon="pi pi-bookmark" (click)="dt.exportExcel({selectionOnly:true})" class="p-button-success p-ml-auto" pTooltip="Selection Only" tooltipPosition="bottom" nbPopover="Télécharger les colones selectionner en un ficher Excel?" nbPopoverTrigger="hint" nbPopoverPlacement="top"></button>
                            <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt)"></button>
                            <span class="p-input-icon-left p-ml-auto">
                                <i class="pi pi-search"></i>
                                <input pInputText nbInput type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />
                            </span>
                    </div>
                  </div>
                </div>
              </div>
          </ng-template>
          <ng-template pTemplate="header" let-columns>
              <tr>
                  <th *ngFor="let col of columns">
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <div *ngIf="col.header!=='Actions' && col.header!=='Consultation'">
                        {{col.header}}
                      </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='NUM_BON'" type="text" field="numBon" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='nom&prenom client'" type="text" field="nomprenomCli" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='adresse de Client'" type="text" field="adresseCli" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          
                          <p-columnFilter *ngIf="col.header=='codFrs'" field="numCom.fournis" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" class="p-ml-auto" style="vertical-align: middle" nbPopover="filtrage par selection?" nbPopoverTrigger="hint" nbPopoverPlacement="right">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold">Choix Fournisseur</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [ngModel]="value" [options]="fournisAllList" placeholder="Any" (onChange)="filter($event.value)" optionLabel="codFrs">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                            <span class="p-ml-1"><b>{{option.codFrs}}</b></span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                          </p-columnFilter>

                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Nom Fournisseur'" field="numCom.fournis" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" class="p-ml-auto" style="vertical-align: middle" nbPopover="filtrage par selection?" nbPopoverTrigger="hint" nbPopoverPlacement="right">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold">Choix Fournisseur</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [ngModel]="value" [options]="fournisAllList" placeholder="Any" (onChange)="filter($event.value)" optionLabel="raison">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                            <span class="p-ml-1"><b>{{option.raison}}</b></span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                          </p-columnFilter>

                          <p-columnFilter *ngIf="col.header=='Nom Fournisseur'" type="text" field="numCom.fournis.raison" display="menu" style="vertical-align: middle" nbPopover="filtrage par input?" nbPopoverTrigger="hint" nbPopoverPlacement="right"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='numBonFrs'" type="text" field="numBonFrs" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Livreur de Bon'" type="text" field="livreur.nom" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='RAISON'" type="text" field="raison" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='LIV'" type="text" field="liv" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='CENTRE'" type="text" field="centre" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='DAT_BON'" type="date" field="datBon" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='BRUT_HT'" type="numeric" field="brutHt" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='TAUX_REM'" type="numeric" field="tauxRem" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='MONT_REM'" type="numeric" field="montRem" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='NET_HT'" type="numeric" field="netHt" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='MONT_TVA'" type="numeric" field="montTva" display="menu" ></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='TOT_TTC'" type="numeric" field="totTtc" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='TAUX_RES'" type="numeric" field="tauxRes" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='MONT_TRS'" type="numeric" field="montTrs" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='MONT_IRPP'" type="numeric" field="montIrpp" display="menu" currency="TND"></p-columnFilter>
                        </div>
                        <div>

                          <p-columnFilter *ngIf="col.header=='Nom&Prenom respensable Bon'" field="user" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" class="p-ml-auto">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold">Choix Agent</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [ngModel]="value" [options]="agents" placeholder="Any" (onChange)="filter($event.value)" optionLabel="firstname">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                            <img [alt]="option.label" src="{{this.utilisateurService.host+'/'+option.codUser+'/'+option.fileName}}" width="32" style="vertical-align: middle" />
                                            <span class="p-ml-1"><b>{{option.firstname}}</b>&nbsp;<b>{{option.lastname}}</b></span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                          </p-columnFilter>

                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Post respensable Bon'" field="user" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" class="p-ml-auto">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold">Agents Post</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [ngModel]="value" [options]="statusessRole" placeholder="Any" (onChange)="filter($event.value)" optionLabel="name">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                            <span class="p-ml-1">{{option.name}}</span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                          </p-columnFilter>

                        </div>
                        <div>

                          <p-columnFilter *ngIf="col.header=='Transaction'" field="trans_action" matchMode="equals" display="menu" class="p-ml-auto">
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-dropdown [ngModel]="value" [options]="statusessTransaction" (onChange)="filter($event.value)" placeholder="Any">
                                    <ng-template let-option pTemplate="item">
                                        <span [class]="option.value">
                                          <span *ngIf="option.label=='Reçu'" style="color: rgb(120, 13, 134);">{{option.label}}</span>
                                          <span *ngIf="option.label=='Envoyer'" style="color:rgb(6, 105, 122);">{{option.label}}</span>
                                        </span>
                                    </ng-template>
                                </p-dropdown>
                            </ng-template>
                          </p-columnFilter>

                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Numéro de command'" type="numeric" field="numCom.numCom" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Date de command'" type="date" field="numCom.datCom" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Nom de command'" type="date" field="numCom.raison" display="menu"></p-columnFilter>
                        </div>
                        <div>
                          <p-columnFilter *ngIf="col.header=='Type de command'" type="text" field="numCom.typCom" display="menu"></p-columnFilter>
                        </div>
                        <div>


                          <p-columnFilter *ngIf="col.header=='Nom&Prenom respensable de Commmand'" field="numCom.user" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" class="p-ml-auto">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold">Choix Agent</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [ngModel]="value" [options]="agents" placeholder="Any" (onChange)="filter($event.value)" optionLabel="firstname">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                            <img [alt]="option.label" src="{{this.utilisateurService.host+'/'+option.codUser+'/'+option.fileName}}" width="32" style="vertical-align: middle" />
                                            <span class="p-ml-1"><b>{{option.firstname}}</b>&nbsp;<b>{{option.lastname}}</b></span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                          </p-columnFilter>
                         
                        </div>
                        <div>

                          <p-columnFilter *ngIf="col.header=='Post respensable de Commmand'" field="numCom.user.roles[0]" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" class="p-ml-auto">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold">Agents Post</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [ngModel]="value" [options]="statusessRole" placeholder="Any" (onChange)="filter($event.value)" optionLabel="name">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_ACHETEUR'">Acheteur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_ADMIN'">Administrateur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_AGENT_CAB'">Agent code a barre</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_AGENT_SAISIE_REG'">Agent saisir reg</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_CAISSIER'">Caissier</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_CLIENT'">Client</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_DECIDEUR_BP'">Decideur Bon Preparation</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_EMBALLEUR'">Emballeur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_EXPEDITEUR'">Expediteur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_PREPARATEUR'">Preparateur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_PREPARATEUR_BR'">Preparateur BR</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_RESPONSABLE_DISPATCHING_BP'">Responsable dispatching BG</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_RESPONSABLE_POINTAGE'">Responsable pointage</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_RESPONSABLE_SERVICE_FRS_ETRANGER'">Responsable service fournisseur etranger</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_RESPONSABLE_SERVICE_FRS_LOCAL'">Responsable service fournisseur etranger</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_TRANSITAIRE'">Transitaire</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_USER'">Utilisateur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_VALIDATEUR_DE_CHARIOT'">Validateur de chariot</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_VENDEUR'">Vendeur</span>
                                          <span class="p-ml-1" *ngIf="option.name=='ROLE_LIVREUR'">Livreur</span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                          </p-columnFilter>

                        </div>
                        <div style="text-align: center" *ngIf="col.header=='Actions' || col.header=='Consultation'">
                          <b>{{col.header}}</b>
                        </div>
                    </div>
                  </th>
              </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
              <tr [pSelectableRow]="rowData">
                  <td *ngFor="let col of columns">
                    <div *ngIf="col.field!=='datBon' && col.field!=='numCom' && col.field!=='user' && col.field!=='livreur' && col.field!=='trans_action' && col.field!=='adresseCli' && col.header!=='Actions' && col.header!=='Consultation'">
                      <div *ngIf="rowData[col.field]==null || rowData[col.field]=='' && rowData[col.field]!==0">
                        <span class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label> Aucune!</label></span>
                      </div>
                      <div *ngIf="rowData[col.field]===0">
                        <span *ngIf="col.field=='brutHt' || col.field=='tauxRem' || col.field=='montRem' || col.field=='netHt' || col.field=='totTtc' || col.field=='montTrs' || col.field=='montIrpp'">TND&nbsp;</span><span style="color: rgb(236, 28, 0);">{{rowData[col.field]}}</span>
                      </div>
                      <div *ngIf="rowData[col.field]!==0">
                        <span *ngIf="col.field=='brutHt' || col.field=='tauxRem' || col.field=='montRem' || col.field=='netHt' || col.field=='totTtc' || col.field=='montTrs' || col.field=='montIrpp'">TND&nbsp;</span>{{rowData[col.field]}}
                      </div>
                    </div>
                    <div *ngIf="col.field=='datBon'">
                      {{rowData[col.field] | date: 'MMM d, y H:mm:ss' : '+0000'}}
                    </div> 
                    <div *ngIf="col.field=='trans_action'">
                      <div style="width: 300px;" *ngIf="rowData[col.field]=='recu'" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color: rgb(120, 13, 134);" >le Bon Livraison est reçu</div></span></div>
                      <div style="width: 300px;" *ngIf="rowData[col.field]=='envoyer'" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color:rgb(6, 105, 122);">le Bon Livraison est envoyer</div></span></div>
                      <div style="width: 300px;" *ngIf="rowData[col.field]==''" style="text-align: center" class="field-multiple-drag"><span><div class="p-mb-3 p-text-italic" style="color: rgb(160, 168, 160);">L'etat de bon livraison n'est pas definie </div></span></div>  
                    </div> 

                    <div *ngIf="col.field=='adresseCli'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field]}}
                      </div>
                      <div *ngIf="rowData[col.field]==null || rowData[col.field]==''">
                        <span class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>

                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='user' && col.header=='Nom&Prenom respensable Bon'">
                        
                      <div *ngIf="rowData[col.field]!==null">
                        <img  (click)="showModalDialogUserTable2(rowData[col.field].id)" src="{{this.utilisateurService.host+'/'+rowData[col.field].codUser+'/'+rowData[col.field].fileName}}" width="32" style="vertical-align: middle" />
                        <span class="image-text"><p>{{rowData[col.field].lastname}}&nbsp;{{rowData[col.field].firstname}}</p></span>
                        <div *ngIf="displayModalUserTable2==true">
                          <p-dialog header="{{util.lastname}} {{util.firstname}}" [(visible)]="displayModalUserTable2" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                          [draggable]="false" [resizable]="false">
                          <p class="p-m-0"><img src="{{this.utilisateurService.host+'/'+util.codUser+'/'+util.fileName}}" style="width:150px;height: 180px;" class="article-image" /></p>
                            
                            <div>
                              <li>                        
                                <span class="image-text"><b class="p-mb-3 p-text-light">Nom et Prénom Responsable :</b> {{util.firstname}}&nbsp;{{util.lastname}}</span>                      
                              </li> 
                              <li>
                                <span class="image-text"><b class="p-mb-3 p-text-light">Email Responsable :</b> {{util.email}}</span>
                              </li>
                              <li>  
                                <span class="image-text"><b class="p-mb-3 p-text-light">Telephone Responsable :</b> {{util.telephone}}</span>
                              </li>
                              <li>
                                <b class="p-mb-3 p-text-light">Role : </b>
                                <b *ngIf="util.roles[0].name==null" class="field-multiple-drag"><span class="p-mb-3 p-text-normal" style="color: rgb(86, 90, 86);" ><label (click)="showPositionDialogUserRole('right')">Aucune Role</label></span></b>

                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_ACHETEUR'">Acheteur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_ADMIN'">Administrateur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_AGENT_CAB'">Agent code a barre</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_AGENT_SAISIE_REG'">Agent saisir reg</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_CAISSIER'">Caissier</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_CLIENT'">Client</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_DECIDEUR_BP'">Decideur Bon Preparation</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_EMBALLEUR'">Emballeur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_EXPEDITEUR'">Expediteur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_PREPARATEUR'">Preparateur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_PREPARATEUR_BR'">Preparateur BR</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_RESPONSABLE_DISPATCHING_BP'">Responsable dispatching BG</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_RESPONSABLE_POINTAGE'">Responsable pointage</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_ETRANGER'">Responsable service fournisseur etranger</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_LOCAL'">Responsable service fournisseur etranger</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_TRANSITAIRE'">Transitaire</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_USER'">Utilisateur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_VALIDATEUR_DE_CHARIOT'">Validateur de chariot</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_VENDEUR'">Vendeur</span>
                                  <span style="color: rgb(114, 212, 16);" *ngIf="util.roles!==null && util.roles[0].name=='ROLE_LIVREUR'">Livreur</span>
                              </li>
                            </div>

                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayModalUserTable2=false" label="Annuler" styleClass="p-button-text"></p-button>
                              </ng-template>
                          </p-dialog>
                        </div>
                      </div>
                      <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                    </div> 
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='user' && col.header=='Post respensable Bon'">
                      <div *ngIf="rowData[col.field]!==null">
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_ACHETEUR'">Acheteur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_ADMIN'">Administrateur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_AGENT_CAB'">Agent code a barre</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_AGENT_SAISIE_REG'">Agent saisir reg</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_CAISSIER'">Caissier</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_CLIENT'">Client</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_DECIDEUR_BP'">Decideur Bon Preparation</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_EMBALLEUR'">Emballeur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_EXPEDITEUR'">Expediteur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_PREPARATEUR'">Preparateur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_PREPARATEUR_BR'">Preparateur BR</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_RESPONSABLE_DISPATCHING_BP'">Responsable dispatching BG</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_RESPONSABLE_POINTAGE'">Responsable pointage</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_ETRANGER'">Responsable service fournisseur etranger</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_LOCAL'">Responsable service fournisseur etranger</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_TRANSITAIRE'">Transitaire</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_USER'">Utilisateur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_VALIDATEUR_DE_CHARIOT'">Validateur de chariot</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_VENDEUR'">Vendeur</span>
                        <span *ngIf="rowData[col.field].roles[0].name=='ROLE_LIVREUR'">Livreur</span>
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Numéro de command'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field].numCom}}
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Date de command'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field].datCom | date: 'MMM d, y H:mm:ss' : '+0000'}}
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Nom de command'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field].raison}}
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Type de command'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field].typCom}}
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Nom&Prenom respensable de Commmand'">
                      <div *ngIf="rowData[col.field]!==null">

                        <img  (click)="showModalDialogUserTable2Command(rowData[col.field].user.id)" src="{{this.utilisateurService.host+'/'+rowData[col.field].user.codUser+'/'+rowData[col.field].user.fileName}}" width="32" style="vertical-align: middle" />
                        <span class="image-text"><p>{{rowData[col.field].user.lastname}}&nbsp;{{rowData[col.field].user.firstname}}</p></span>
                        <div *ngIf="displayModalUserTable2Command==true">
                          <p-dialog header="{{util2.lastname}} {{util2.firstname}}" [(visible)]="displayModalUserTable2Command" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                          [draggable]="false" [resizable]="false">
                          <p class="p-m-0"><img src="{{this.utilisateurService.host+'/'+util2.codUser+'/'+util2.fileName}}" style="width:250px" class="article-image" /></p>
                          
                            <div>
                              <li>                        
                                <span class="image-text"><b class="p-mb-3 p-text-light">Nom et Prénom Responsable :</b> {{util2.firstname}}&nbsp;{{util2.lastname}}</span>                      
                              </li> 
                              <li>
                                <span class="image-text"><b class="p-mb-3 p-text-light">Email Responsable :</b> {{util2.email}}</span>
                              </li>
                              <li>  
                                <span class="image-text"><b class="p-mb-3 p-text-light">Telephone Responsable :</b> {{util2.telephone}}</span>
                              </li>
                              <li>
                                <b class="p-mb-3 p-text-light">Role : </b>
                                <b *ngIf="util2.roles[0].name==null" class="field-multiple-drag"><span class="p-mb-3 p-text-normal" style="color: rgb(86, 90, 86);" ><label (click)="showPositionDialogUserRole('right')">Aucune Role</label></span></b>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_ACHETEUR'">Acheteur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_ADMIN'">Administrateur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_AGENT_CAB'">Agent code a barre</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_AGENT_SAISIE_REG'">Agent saisir reg</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_CAISSIER'">Caissier</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_CLIENT'">Client</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_DECIDEUR_BP'">Decideur Bon Preparation</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_EMBALLEUR'">Emballeur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_EXPEDITEUR'">Expediteur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_PREPARATEUR'">Preparateur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_PREPARATEUR_BR'">Preparateur BR</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_RESPONSABLE_DISPATCHING_BP'">Responsable dispatching BG</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_RESPONSABLE_POINTAGE'">Responsable pointage</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_ETRANGER'">Responsable service fournisseur etranger</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_LOCAL'">Responsable service fournisseur etranger</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_TRANSITAIRE'">Transitaire</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_USER'">Utilisateur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_VALIDATEUR_DE_CHARIOT'">Validateur de chariot</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_VENDEUR'">Vendeur</span>
                                <span style="color: rgb(114, 212, 16);" *ngIf="util2.roles!==null && util2.roles[0].name=='ROLE_LIVREUR'">Livreur</span>
                              </li>
                            </div>

                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayModalUserTable2Command=false" label="Annuler" styleClass="p-button-text"></p-button>
                              </ng-template>
                          </p-dialog>
                        </div>
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Post respensable de Commmand'">
                      <div *ngIf="rowData[col.field]!==null">
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_ACHETEUR'">Acheteur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_ADMIN'">Administrateur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_AGENT_CAB'">Agent code a barre</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_AGENT_SAISIE_REG'">Agent saisir reg</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_CAISSIER'">Caissier</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_CLIENT'">Client</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_DECIDEUR_BP'">Decideur Bon Preparation</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_EMBALLEUR'">Emballeur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_EXPEDITEUR'">Expediteur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_PREPARATEUR'">Preparateur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_PREPARATEUR_BR'">Preparateur BR</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_RESPONSABLE_DISPATCHING_BP'">Responsable dispatching BG</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_RESPONSABLE_POINTAGE'">Responsable pointage</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_ETRANGER'">Responsable service fournisseur etranger</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_RESPONSABLE_SERVICE_FRS_LOCAL'">Responsable service fournisseur etranger</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_TRANSITAIRE'">Transitaire</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_USER'">Utilisateur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_VALIDATEUR_DE_CHARIOT'">Validateur de chariot</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_VENDEUR'">Vendeur</span>
                        <span *ngIf="rowData[col.field].user.roles[0].name=='ROLE_LIVREUR'">Livreur</span>
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='codFrs'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field].fournis.codFrs}}
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                    <div style="text-align: center" class="field-multiple-drag" *ngIf="col.field=='numCom' && col.header=='Nom Fournisseur'">
                      <div *ngIf="rowData[col.field]!==null">
                        {{rowData[col.field].fournis.raison}}
                      </div>
                      <div *ngIf="rowData[col.field]==null">
                        <span *ngIf="rowData[col.field]==null" class="p-mb-3 p-text-normal" style="color: rgb(160, 168, 160);" ><label>Aucune!</label></span>
                      </div>
                    </div>
                      <!--button Actions -->  
                      <div *ngIf="col.header=='Consultation' && col.field=='numBon'">
                        <button style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton type="button" [status]="info" size="small" [shape]="semi-round" class="btn btn-md btn-outline-info" [routerLink]="['bon-liv-detail',rowData[col.field]]" outline>
                          <i class="fa fa-search"></i>Details</button>
                        <button (click)="openWindowXbaseXtva(rowData[col.field])" style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton type="button" [shape]="semi-round" size="small" [status]="primary" class="btn btn-md btn-outline-primary" outline>
                            XBASE & XTVA</button>
                      </div>
                      <div *ngIf="col.header=='Actions' && col.field=='numBon' && (authority==='ROLE_ADMIN' || authority==='ROLE_PREPARATEUR_BR' || authority==='ROLE_RESPONSABLE_DISPATCHING_BP' || authority==='ROLE_RESPONSABLE_POINTAGE')">
                        <button style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton type="button" [status]="warning" size="small" [shape]="semi-round" class="btn btn-md btn-outline-warning" (click)="goToModifier(rowData[col.field])" outline>
                          <i class="fa fa-edit"></i>Modifier</button>
                        <button style="border-radius: 0.75rem;width: 110px;height: 38px;" nbButton class="btn btn-md btn-outline-danger" type="button" [shape]="semi-round" size="small" [status]="danger" (click)="OpenDeletePopap(rowData[col.field])" outline>
                          <i class="fa fa-remove"></i>Supprimer</button>
                      </div>
                      <!--end button Actions -->
                  </td>
              </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="31">Pas de BonLivs trouver.</td>
            </tr>
        </ng-template>
      </p-table>
    </div>
  </nb-card-body>
</nb-card>
