

<!--table art Liv-->

<nb-card>
  <nb-card-body>
        <div>
          <img src="assets/images/toulsImages/fleshe.png" width="32" style="vertical-align: middle" nbPopover="Retourner à la liste des Bon de Sortie?" nbPopoverTrigger="hint" nbPopoverPlacement="right" [routerLink]="['../../../bon-liv-list']"/>
          <p></p>
          <h4>Details de Bon Livraison</h4>
          <nb-card-header>
                <div><b>Code Bon Livraison : </b>{{ bonliv.numBon }}</div>

                <div><b>Date Bon Livraison : </b>{{ bonliv.datBon | date: 'MMM d, y, h:mm:ss a' :'+0000'}}</div>
            </nb-card-header>
        </div>
        <p>Table  des Articles appartient a la livraison</p>
<!-- bon livraison recu -->
        <div *ngIf="bonliv.trans_action=='recu'">
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>
                  <div class="p-d-flex p-jc-between p-ai-center">
                    <label class="label">N~ Command</label> 
                  </div>
                </th>                  
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Raison Command</label> 
                    </div>
                  </th>
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Date Command</label>  
                    </div>
                  </th>
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Type Command</label>
                    </div>
                  </th>  
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">fournisseur</label>
                    </div>
                  </th> 
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Adresse Fournisseur</label>
                    </div>
                  </th>
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Telephone fournisseur</label>
                    </div>
                  </th>  
                  
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Fax fournisseur</label>
                      
                    </div>
                  </th> 
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">l'emplacement</label>
                      
                    </div>
                  </th>                       
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogNumCom('right')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogNumCom('right')"><p>{{ bonliv.numCom.numCom }}</p></label>                  
                  <p-dialog header="Definition Num Com" [(visible)]="displayPositionNumCom" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>
                    Numéro de command.
                  </nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionNumCom=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogRaison('right')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogRaison('right')"><p>{{ bonliv.numCom.raison }}</p></label>
                  <p-dialog header="Definition Raison" [(visible)]="displayPositionRaison" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>
                    Raison de la command est le nom associer au fournis.
                  </nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionRaison=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogDatCom('bottom')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogDatCom('bottom')"><p>{{ bonliv.numCom.datCom | date: 'MMM d, y H:mm:ss' : '+0000'}}</p></label>
                  <p-dialog header="Definition Dat Com" [(visible)]="displayPositionDatCom" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>datCom est la date de command .</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionDatCom=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogTypCom('bottom')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogTypCom('bottom')"><p>{{ bonliv.numCom.typCom }}</p></label>
                  <p-dialog header="Definition Typ Com" [(visible)]="displayPositionTypCom" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>typCom est le type de la command .</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionTypCom=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogCodFrs('bottom')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogCodFrs('bottom')"><p>{{ bonliv.numCom.fournis.codFrs }}</p></label>
                  <p-dialog header="Définition Cod Frs" [(visible)]="displayPositionCodFrs" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>codFrs est le code de Fournisseur qui a mis en place la command si il s agit d'un fournisseur existe dans notre base.</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionCodFrs=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogAdresse('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogAdresse('left')"><p>{{ bonliv.numCom.fournis.adresse}}</p></label>
                  <p-dialog header="Définition Adresse" [(visible)]="displayPositionAdresse" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>adresse est l'adresse de fournisseur qui a mis en place la command.</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionAdresse=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogTel('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogTel('left')"><p>{{ bonliv.numCom.fournis.tel}}</p></label>
                  <p-dialog header="Définition Tel" [(visible)]="displayPositionTel" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>tel est telephone ou on peut le contacter.</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionTel=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogFax('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogFax('left')" styleClass="p-button-warning"><p>{{ bonliv.numCom.fournis.fax }}</p></label>
                  <p-dialog header="Définition Fax" [(visible)]="displayPositionFax" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>fax est N~ Fax ou on peut le contacter.</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionFax=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
                <td>
                  <label *ngIf="bonliv.numCom==null" (click)="showPositionDialogPaye('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                  <label *ngIf="bonliv.numCom!==null" (click)="showPositionDialogPaye('left')"><p>{{ bonliv.numCom.fournis.paye }}</p></label>
                  <p-dialog header="Définition Paye" [(visible)]="displayPositionPaye" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                  [draggable]="false" [resizable]="false">
                  <nb-card-body>paye est la paye ou cetter fournisseur exist .</nb-card-body>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayPositionPaye=false" label="Annuler" styleClass="p-button-text"></p-button>
                      </ng-template>
                  </p-dialog>
                </td>
              </tr>
              </tbody>
              </table>
        </div>


        <!-- bon livraison envoyer -->
      <div *ngIf="bonliv.trans_action=='envoyer'">
        <p-table #dt1 [value]="artlivs" dataKey="id"
            [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading" styleClass="p-datatable-customers p-datatable-gridlines"
            [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [globalFilterFields]="['cod_art','qutLiv','remise','prixHt','tva','totHt','marge','typArt','cumulRet','prixAch','remExp','centre']">
            <ng-template pTemplate="caption">
                <div class="p-d-flex">
                    <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
                    <span class="p-input-icon-left p-ml-auto">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />
                    </span>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                  <th>
                    <div class="p-d-flex p-jc-between p-ai-center">
                      <label class="label">Code Article </label>
                      <div>
                        <p-columnFilter type="text" field="cod_art" display="menu"></p-columnFilter>
                      </div>
                    </div>
                  </th>                  
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Quantité Livrai</label>
                        <div>
                          <p-columnFilter type="numeric" field="qutLiv" display="menu"></p-columnFilter>
                        </div>
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Remise</label> 
                        <div>
                          <p-columnFilter type="numeric" field="remise" display="menu" currency="TND"></p-columnFilter>
                        </div>
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Prix Ht</label> 
                        <div> 
                          <p-columnFilter type="numeric" field="prixHt" display="menu" currency="TND"></p-columnFilter>
                        </div>
                      </div>
                    </th>  
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Tva</label> 
                        <div> 
                          <p-columnFilter type="numeric" field="tva" display="menu"></p-columnFilter>
                        </div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Tot Ht</label> 
                        <div> 
                          <p-columnFilter type="numeric" field="totHt" display="menu" currency="TND"></p-columnFilter>
                        </div>
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Marge</label>
                        <div> 
                          <p-columnFilter type="numeric" field="marge" display="menu"></p-columnFilter>
                        </div>
                      </div>
                    </th>  
                    
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Typ Article</label>
                        <div> 
                          <p-columnFilter type="text" field="typArt" display="menu" ></p-columnFilter>
                        </div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Cumul Ret</label>
                        <div> 
                          <p-columnFilter type="numeric" field="cumulRet" display="menu" currency="TND"></p-columnFilter>
                        </div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Prix Ach</label>
                        <div> 
                          <p-columnFilter type="numeric" field="prixAch" display="menu" currency="TND"></p-columnFilter>
                        </div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Rem Exp</label>
                        <div>
                          <p-columnFilter type="numeric" field="remExp" display="menu" currency="TND"></p-columnFilter>
                        </div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Centre</label>
                        <div>
                          <p-columnFilter type="text" field="centre" display="menu"></p-columnFilter>
                        </div>
                      </div>
                    </th>
                    
                </tr>
            </ng-template>


            <ng-template pTemplate="body" let-artliv>
                  <tr>
                    <td>
                      <label *ngIf="artliv.cod_art==null"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.cod_art!==null" (click)="showModalDialog(artliv.cod_art)">{{ artliv.cod_art }}</label>

                      <p-dialog [(visible)]="displayModal" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <div style="text-align: center" class="field-multiple-drag" *ngIf="displayModal===true">
                        <li>                
                          <span class="image-text"><b class="p-mb-3 p-text-light"><nb-card-body>Marque article :</nb-card-body></b> <nb-card-body>{{artic.marque.title}}</nb-card-body>&nbsp;&nbsp;<img style="width:40px;height: 40px;" src="{{this.marqueService.host+'/'+artic.marque.code+'/'+artic.marque.fileName}}" [alt]="artic.marque.title"/></span>                      
                        </li> 
                        <li>
                          <span class="image-text"><b class="p-mb-3 p-text-light"><nb-card-body>Model article :</nb-card-body></b>&nbsp;<nb-card-body>{{artic.model.title}}</nb-card-body></span>
                        </li>
                      </div>
                      <div>
                        <p style="text-align: center" class="field-multiple-drag"><img *ngIf="displayModal==true" src="{{this.articleService.host+'/'+artic.codArt+'/'+artic.fileName}}" style="width:250px;" /></p>
                      </div>
                      <ng-template pTemplate="footer">
                          <p-button icon="pi pi-check" (click)="displayModal=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                  </td>
                    <td>
                      <label *ngIf="artliv.qutLiv==null" (click)="showPositionDialogQutLiv('right')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.qutLiv!==null" (click)="showPositionDialogQutLiv('right')">{{ artliv.qutLiv }}</label>
                      <p-dialog header="Definition Qut Liv" [(visible)]="displayPositionQutLiv" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Quantité c'est la quantité d'Article preparer par L'Agent de Préparation</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionQutLiv=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label *ngIf="artliv.remise==null" (click)="showPositionDialogRemise('right')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.remise!==null" (click)="showPositionDialogRemise('right')">{{ artliv.remise | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Definition Remise" [(visible)]="displayPositionRemise" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>une remise est la déduction que fait un commerçant sur le prix facturé, en raison, par exemple, de ce que l'acheteur a payé au comptant, en raison encore de qu'il a fait un achat d'une valeur importante, soit encore parce que la marchandise était déclassée.</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionRemise=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label *ngIf="artliv.prixHt==null" (click)="showPositionDialogPrixHt('bottom')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.prixHt!==null" (click)="showPositionDialogPrixHt('bottom')">{{ artliv.prixHt | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Definition Prix Ht" [(visible)]="displayPositionPrixHt" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <p>Le prix hors taxe (HT) est celui qui est facturé au client sans tenir compte des différentes taxes prélevées par l'État,Le HT se rencontre dans les cas d'auto-liquidation de la TVA ou d'opérations en duty free.</p>
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionPrixHt=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label *ngIf="artliv.tva==null" (click)="showPositionDialogTva('bottom')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.tva!==null" (click)="showPositionDialogTva('bottom')">{{ artliv.tva}} %</label>
                      <p-dialog header="Definition Prix Ht" [(visible)]="displayPositionTva" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>La TVA est une taxe qui vient s'ajouter au prix de tous les produits qui y sont assujettis, c'est-à-dire la quasi-totalité. ... Il permet ainsi aux entreprises de déduire des sommes à reverser à l'État le montant de la TVA qu'elles ont acquitté sur leurs achats. Au final, seul le consommateur final supporte la TVA.</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionTva=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label *ngIf="artliv.totHt==null" (click)="showPositionDialogTotHt('bottom')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.totHt!==null" (click)="showPositionDialogTotHt('bottom')">{{ artliv.totHt | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Tot Ht" [(visible)]="displayPositionTotHt" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>HT signifie Hors Taxe. La mention HT permet d'indiquer qu'un prix ne comprend pas la Taxe sur la Valeur Ajoutée.</nb-card-body> 
                      <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionTotHt=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label *ngIf="artliv.marge==null" (click)="showPositionDialogMarge('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.marge!==null" (click)="showPositionDialogMarge('left')">{{ artliv.marge | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Marge" [(visible)]="displayPositionMarge" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>La marge commerciale est la différence entre le prix de vente des marchandises et le coût d'achat de ces marchandises vendues.</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionMarge=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <nb-card-body>{{ artliv.typArt}}</nb-card-body>
                    </td>
                    <td>
                      <label *ngIf="artliv.cumulRet==null" (click)="showPositionDialogCumulRet('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.cumulRet!==null" (click)="showPositionDialogCumulRet('left')">{{ artliv.cumulRet | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Cumul Ret" [(visible)]="displayPositionCumulRet" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Produit mis en vente.</nb-card-body>
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionCumulRet=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label *ngIf="artliv.prixAch==null" (click)="showPositionDialogPrixAch('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.prixAch!==null" (click)="showPositionDialogPrixAch('left')" styleClass="p-button-warning">{{ artliv.prixAch | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Prix Ach" [(visible)]="displayPositionPrixAch" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Le prix d'achat correspond au prix auquel le fournisseur ou le producteur vend son produit,Sur une facture, cela correspond au prix brut unitaire. Ce prix est exprimé hors taxes. Le coût d'achat correspond au prix d'achat auquel on ajoute les frais d'achat.</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionPrixAch=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      {{ artliv.remExp | currency:'TND ':'symbol'}}
                    </td>
                    <td>
                      <label *ngIf="artliv.centre==null" (click)="showPositionDialogCentre('left')"><b class="p-mb-3 p-text-italic" style="color: rgb(177, 157, 157);" >Pas mentionné</b></label>
                      <label *ngIf="artliv.centre!==null" (click)="showPositionDialogCentre('left')">{{ artliv.centre}}</label>
                      <p-dialog header="Définition Centre" [(visible)]="displayPositionCentre" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Le centre de Préparation de Article .</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionCentre=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    
                  </tr>
            </ng-template>
          
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="12"><nb-card-body>No bonlivs found.</nb-card-body></td>
                </tr>
            </ng-template>
        </p-table>
      </div>
      </nb-card-body>
</nb-card>

<!--table art Term-->
<div *ngIf="bonliv.trans_action=='envoyer'">
<nb-card>
<nb-card-body>
        <p>Table  des Terms Articles</p>
        <p-table #dt1 [value]="artterms" dataKey="numBonFac"
            [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading" class="p-tableCss" styleClass="p-datatable-customers p-datatable-gridlines"
            [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [globalFilterFields]="['numBonFac','numBon','date','netHt','tva','totTtc','montTrs']">
            <ng-template pTemplate="caption">
                <div class="p-d-flex">
                    <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
                    <span class="p-input-icon-left p-ml-auto">
                        <i class="pi pi-search"></i>
                        <input pInputText nbInput type="text" (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />
                    </span>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">N~ Term</label> 
                          <div><p-columnFilter type="text" field="numBonFac" display="menu"></p-columnFilter></div>
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">N~ Doc</label>  
                        <div><p-columnFilter type="numeric" field="numBon" display="menu" ></p-columnFilter></div>
                      </div>
                    </th>  
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Date</label>   
                        <div><p-columnFilter type="date" field="date" display="menu"></p-columnFilter></div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Net HT</label> 
                        <div><p-columnFilter type="numeric" field="netHt" display="menu" currency="TND"></p-columnFilter></div>
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Tva</label>  
                        <div><p-columnFilter type="numeric" field="tva" display="menu"></p-columnFilter></div>
                      </div>
                    </th>  
                    
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Tot Ttc</label>  
                        <div><p-columnFilter type="numeric" field="totTtc" display="menu" currency="TND"></p-columnFilter></div>
                      </div>
                    </th> 
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Mont Trs</label>   
                        <div><p-columnFilter type="numeric" field="montTrs" display="menu" currency="TND"></p-columnFilter></div>
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        <label class="label">Doc Facture</label>  
                      </div>
                    </th>                     
                </tr>
            </ng-template>


            <ng-template pTemplate="body" let-artterm>
                  <tr>
                    <td>
                      <label (click)="showPositionDialogNumBonFac('left')">{{ artterm.numBonFac }}</label>
                      <p-dialog header="Définition NumBonFac" [(visible)]="displayPositionNumBonFac" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Le Numéreau de Bon Facture de Préparation de Article .</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionNumBonFac=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label (click)="showPositionDialogNumBon('left')">{{ artterm.numBon}}</label>
                      <p-dialog header="Définition Numéreau de bon de Préparation" [(visible)]="displayPositionNumBon" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Le Numéreau de Bon de Preparation de Article .</nb-card-body>  
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionNumBon=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label (click)="showPositionDialogDate('left')">{{ artterm.date | date: 'MMM d, y H:mm:ss' : '+0000'}}</label>
                      <p-dialog header="Définition Date" [(visible)]="displayPositionDate" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>La date de Bon de Preparation de Article .</nb-card-body>  
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionDate=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label (click)="showPositionDialogNetHt('left')">{{ artterm.netHt | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Net Ht" [(visible)]="displayPositionNetHt" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>C’est la somme des montants hors taxes et des frais divers diminuée de la réduction globale. TOTAL HT = somme des montants HT - réduction globale + frais divers Le total hors taxes correspond à la base d’imposition à la TVA des opérations taxables.</nb-card-body> 
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionNetHt=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label (click)="showPositionDialogTva2('left')">{{ artterm.tva }}%</label>
                      <p-dialog header="Définition Tva" [(visible)]="displayPositionTva2" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>La TVA est une taxe qui vient s'ajouter au prix de tous les produits qui y sont assujettis, c'est-à-dire la quasi-totalité. ... Il permet ainsi aux entreprises de déduire des sommes à reverser à l'État le montant de la TVA qu'elles ont acquitté sur leurs achats. Au final, seul le consommateur final supporte la TVA.</nb-card-body>   
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionTva2=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label (click)="showPositionDialogTotTtc('left')">{{ artterm.totTtc | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Tot Ttc" [(visible)]="displayPositionTotTtc" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>(TTC) est utilisée pour désigner un prix sur lequel toutes les taxes dues par le client sont prises en compte. Le prix TTC prend en compte la taxe sur la valeur ajoutée ou TVA. ... Le prix TTC est donc supérieur au prix hors taxe (souvent désigné par l'acronyme HT).</nb-card-body>  
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionTotTtc=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <label (click)="showPositionDialogMontTrs('left')">{{ artterm.montTrs | currency:'TND ':'symbol'}}</label>
                      <p-dialog header="Définition Mont Trs" [(visible)]="displayPositionMontTrs" [position]="position" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
                      [draggable]="false" [resizable]="false">
                      <nb-card-body>Le taux de rendement synthétique (ou TRS) est un indicateur destiné à suivre le taux d'utilisation de machines.Il est défini par la formule :
          
                        TRS = Production réelle / production maximum théorique
                        La définition du TRS est un standard propre à chaque organisation qui le définit. Ainsi, pour une situation donnée, le TRS calculé sera différent selon les organisations qui le calculent.</nb-card-body>  
                          <ng-template pTemplate="footer">
                              <p-button icon="pi pi-check" (click)="displayPositionMontTrs=false" label="Annuler" styleClass="p-button-text"></p-button>
                          </ng-template>
                      </p-dialog>
                    </td>
                    <td>
                      <nb-card-body>{{ artterm.facture.numDoc}}</nb-card-body>  
                    </td>
                  </tr>
            </ng-template>
          
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="9"><nb-card-body>No Details bonlivs found.</nb-card-body></td>
                </tr>
            </ng-template>
        </p-table>
  </nb-card-body>
  </nb-card>
</div>